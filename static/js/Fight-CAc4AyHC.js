import{a as C}from"./axios-BA-LBiZu.js";import{_ as O,r as R,B as F,t as I,g as k,A as N,w as g,b as l,a as o,c as B,D as V,d as n,G as M,F as $,i as u,f as _,p as W,h as J,Q as S,o as T,M as w}from"./index-B_nqqRHS.js";import{a as j}from"./roleApi-CpmGp-wS.js";const L={toRole:t=>C("postjson","/fightToRole",t),toMonster:t=>C("postjson","/fightToMonster",t),toBoss:t=>C("postjson","/fightToBoss",t),toImitMonster:t=>C("postjson","/fightToImitMonster",t),toImitBoss:t=>C("postjson","/fightToImitBoss",t)},A={name:"FightModal",props:{modalVisible:{default:!1,type:Boolean},fightLog:{default:[],type:Array}},emits:["submit"],setup(t,p){const h=R({}),s=()=>{p.emit("submit")},b=F(()=>{let f=0,d=0;return t.fightLog.map((i,e)=>{let r={},m={};e%2===0?(r=JSON.parse(JSON.stringify(i.myAttr)),m=JSON.parse(JSON.stringify(i.enemyAttr))):(r=JSON.parse(JSON.stringify(i.enemyAttr)),m=JSON.parse(JSON.stringify(i.myAttr))),f=r.hp/r.oriHp*100,d=m.hp/m.oriHp*100;let v={...i,aggressor:{...r,hpPercent:f>0?f.toFixed(2):"0"},victim:{...m,hpPercent:d>0?d.toFixed(2):"0"}};return console.log(v),v})});return{...I(t),...I(h),submit:s,fightLogRender:b}}},H=t=>(W("data-v-eba12644"),t=t(),J(),t),P=u(" ok "),D={class:"LogContent"},Q={class:"logs"},U={class:"logsItem"},z={class:"sub"},E={class:"oriHp"},G=H(()=>o("div",{class:"detail"},"2",-1)),q={class:"obj"},K={class:"oriHp"};function X(t,p,h,s,b,f){const d=_("a-button"),i=_("a-modal");return k(),N(i,{open:h.modalVisible,"onUpdate:open":p[0]||(p[0]=e=>h.modalVisible=e),title:t.$t("battleLog"),width:"1024px"},{footer:g(()=>[l(d,{type:"primary",onClick:s.submit,onCancel:s.submit},{default:g(()=>[P]),_:1},8,["onClick","onCancel"])]),default:g(()=>[o("div",D,[(k(!0),B($,null,V(s.fightLogRender,(e,r)=>(k(),B("div",Q,[o("p",null,n(t.$t("round"))+" "+n(r+1),1),o("div",U,[o("div",z,[o("span",null,n(e.sub),1),o("span",E,[o("span",{class:"hp",style:M(`width: ${e.aggressor.hpPercent}px`)},null,4)]),o("span",null,n(e.aggressor.hpPercent)+"%",1),o("span",null," hp: "+n(e.aggressor.hp)+"/"+n(e.aggressor.oriHp),1),o("span",null,"waigong: "+n(e.aggressor.waigong),1),o("span",null,"neigong: "+n(e.aggressor.neigong),1),o("span",null,"waifang: "+n(e.aggressor.waifang),1),o("span",null,"neifang: "+n(e.aggressor.neifang),1),o("span",null,"huixin: "+n(e.aggressor.huixin),1),o("span",null,"huishang: "+n(e.aggressor.huishang),1),o("span",null,"renxing: "+n(e.aggressor.renxing),1)]),G,o("div",q,[o("span",null,n(e.obj),1),o("span",K,[o("span",{class:"hp",style:M(`width: ${e.victim.hpPercent}px`)},null,4)]),o("span",null,n(e.victim.hpPercent),1),o("span",null," hp: "+n(e.victim.hp)+"/"+n(e.victim.oriHp),1),o("span",null,"waigong: "+n(e.victim.waigong),1),o("span",null,"neigong: "+n(e.victim.neigong),1),o("span",null,"waifang: "+n(e.victim.waifang),1),o("span",null,"neifang: "+n(e.victim.neifang),1),o("span",null,"huixin: "+n(e.victim.huixin),1),o("span",null,"huishang: "+n(e.victim.huishang),1),o("span",null,"renxing: "+n(e.victim.renxing),1)])])]))),256)),o("p",null,n(h.fightLog[h.fightLog.length-1].sub)+" win",1)])]),_:1},8,["open","title"])}const Y=O(A,[["render",X],["__scopeId","data-v-eba12644"]]),Z={name:"Fight",components:{FightModal:Y,QuestionCircleOutlined:S},setup(){const t=R({enemyName:"",enemyId:"",roleOptionsList:[{value:"jack",label:"Jack"},{value:"lucy",label:"Lucy"},{value:"tom",label:"Tom"}],fightLog:[],currentMonsterWinRate:"0%",currentBossWinRate:"0%",modalVisible:!1});T(async()=>{await p(),await f(),await d()});const p=async()=>{let a=await j.getRoleList({});t.roleOptionsList=a.data.map(c=>({label:c.nickname,value:c.uid}))},h=async()=>{w.confirm({title:`Do you Want to attack for ${t.enemyName}?`,content:l("div",{style:"color:red;"}),async onOk(){let a=await L.toRole({uid:sessionStorage.getItem("uid"),enemyId:String(t.enemyId)});t.fightLog=a.data.fightLog,t.modalVisible=!0},onCancel(){console.log("Cancel")},class:"test"})},s=async()=>{w.confirm({title:"Do you Want to attack for Monster?",content:l("div",{style:"color:red;"}),async onOk(){let a=await L.toMonster({uid:sessionStorage.getItem("uid")});t.fightLog=a.data.fightLog,t.modalVisible=!0},onCancel(){console.log("Cancel")},class:"test"})},b=async()=>{w.confirm({title:"Do you Want to attack for Boss?",content:l("div",{style:"color:red;"}),async onOk(){let a=await L.toBoss({uid:sessionStorage.getItem("uid")});t.fightLog=a.data.fightLog,t.modalVisible=!0},onCancel(){console.log("Cancel")},class:"test"})},f=async()=>{let a=await L.toImitMonster({uid:sessionStorage.getItem("uid")}),c=0;for(let y=0;y<a.data.fightLogs.length;y++)a.data.fightLogs[y].sub==="admin"&&c++;t.currentMonsterWinRate=c+"%"},d=async()=>{let a=await L.toImitBoss({uid:sessionStorage.getItem("uid")}),c=0;for(let y=0;y<a.data.fightLogs.length;y++)a.data.fightLogs[y].sub==="admin"&&c++;t.currentBossWinRate=c+"%"},i=a=>{t.enemyName=t.roleOptionsList.find(c=>c.value===a).label},e=()=>{},r=()=>{},m=(a,c)=>c.value.toLowerCase().indexOf(a.toLowerCase())>=0,v=()=>{t.modalVisible=!1};return{...I(t),filterOption:m,handleChange:i,handleBlur:e,handleFocus:r,QuestionCircleOutlined:S,toRole:h,toMonster:s,toImitMonster:f,toImitBoss:d,toBoss:b,modalClose:v}}},x={class:"fight"},tt={class:"toRole"},ot={class:"toMonster"},nt={class:"toBoss"};function et(t,p,h,s,b,f){const d=_("a-select"),i=_("a-button"),e=_("QuestionCircleOutlined"),r=_("a-tooltip"),m=_("FightModal");return k(),B($,null,[o("div",x,[o("div",tt,[o("p",null,n(t.$t("toRole")),1),l(d,{value:t.enemyId,"onUpdate:value":p[0]||(p[0]=v=>t.enemyId=v),"show-search":"",placeholder:"Select a person",options:t.roleOptionsList,"filter-option":s.filterOption,onFocus:s.handleFocus,onBlur:s.handleBlur,onChange:s.handleChange},null,8,["value","options","filter-option","onFocus","onBlur","onChange"]),l(i,{type:"primary",onClick:s.toRole,disabled:!t.enemyId},{default:g(()=>[u(n(t.$t("attack")),1)]),_:1},8,["onClick","disabled"])]),o("div",ot,[o("p",null,n(t.$t("toMonster")),1),l(i,{type:"primary",onClick:s.toMonster},{default:g(()=>[u(n(t.$t("attack")),1)]),_:1},8,["onClick"]),l(i,{type:"primary",onClick:s.toImitMonster},{default:g(()=>[u(n(t.$t("imitAttack")),1)]),_:1},8,["onClick"]),o("div",null,[u(n(t.$t("currentWinRate"))+" "+n(t.currentMonsterWinRate)+" ",1),l(r,null,{title:g(()=>[u(n(t.$t("monsterTips")),1)]),default:g(()=>[l(e,{style:{color:"#d2d2d2"}})]),_:1})])]),o("div",nt,[o("p",null,n(t.$t("toBoss")),1),l(i,{type:"primary",onClick:s.toBoss},{default:g(()=>[u(n(t.$t("attack")),1)]),_:1},8,["onClick"]),l(i,{type:"primary",onClick:s.toImitBoss},{default:g(()=>[u(n(t.$t("imitAttack")),1)]),_:1},8,["onClick"]),o("div",null,[u(n(t.$t("currentWinRate"))+" "+n(t.currentBossWinRate)+" ",1),l(r,null,{title:g(()=>[u(n(t.$t("bossTips")),1)]),default:g(()=>[l(e,{style:{color:"#d2d2d2"}})]),_:1})])])]),l(m,{modalVisible:t.modalVisible,fightLog:t.fightLog,onSubmit:s.modalClose},null,8,["modalVisible","fightLog","onSubmit"])],64)}const lt=O(Z,[["render",et],["__scopeId","data-v-369564d2"]]);export{lt as default};
//# sourceMappingURL=Fight-CAc4AyHC.js.map
