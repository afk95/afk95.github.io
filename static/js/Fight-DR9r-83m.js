import{a as _}from"./axios-CRdZZQ1N.js";import{_ as N,r as T,x as V,t as L,g as $,m as A,w as d,b as a,a as s,d as o,c as k,z as B,F as R,C as O,i as c,f as b,p as J,h as H,Q as S,n as j,o as Q,M as I}from"./index-D-RyADJy.js";import{a as P}from"./roleApi-DvLIbOGg.js";const w={toRole:t=>_("postjson","/fightToRole",t),toMonster:t=>_("postjson","/fightToMonster",t),toBoss:t=>_("postjson","/fightToBoss",t),toImitMonster:t=>_("postjson","/fightToImitMonster",t),toImitBoss:t=>_("postjson","/fightToImitBoss",t)},z={name:"FightModal",props:{modalVisible:{default:!1,type:Boolean},fightLog:{default:[],type:Array},spoils:{default:[],type:Array}},emits:["submit"],setup(t,n){const u=T({}),i=()=>{n.emit("submit")},M=V(()=>{let h=0,m=0;return t.fightLog.map((r,e)=>{let p={},f={};return e%2===0?(p=JSON.parse(JSON.stringify(r.myAttr)),f=JSON.parse(JSON.stringify(r.enemyAttr))):(p=JSON.parse(JSON.stringify(r.enemyAttr)),f=JSON.parse(JSON.stringify(r.myAttr))),h=p.hp/p.oriHp*100,m=f.hp/f.oriHp*100,{...r,aggressor:{...p,hpPercent:h>0?h.toFixed(2):"0"},victim:{...f,hpPercent:m>0?m.toFixed(2):"0"}}})});return{...L(t),...L(u),submit:i,fightLogRender:M}}},U=t=>(J("data-v-0b156f34"),t=t(),H(),t),D=U(()=>s("span",null,"战利品：",-1)),E={key:0},q={style:{"margin-right":"5px"}},G=c(" 关闭 "),K={class:"LogContent"},X={class:"logs"},Y={class:"logsItem"},Z={class:"sub"},x={class:"oriHp"},tt={class:"detail"},ot={class:"obj"},st={class:"oriHp"};function nt(t,n,u,i,M,h){const m=b("a-button"),r=b("a-modal");return $(),A(r,{open:u.modalVisible,"onUpdate:open":n[0]||(n[0]=e=>u.modalVisible=e),title:t.$t("battleLog"),width:"1024px"},{footer:d(()=>[a(m,{type:"primary",onClick:i.submit,onCancel:i.submit},{default:d(()=>[G]),_:1},8,["onClick","onCancel"])]),default:d(()=>[s("p",null,"结果："+o(u.fightLog[u.fightLog.length-1].sub)+" 胜",1),D,u.spoils.length===0?($(),k("span",E,"无")):($(!0),k(R,{key:1},B(u.spoils,e=>($(),k("span",q,o(e.name),1))),256)),s("div",K,[($(!0),k(R,null,B(i.fightLogRender,(e,p)=>($(),k("div",X,[s("p",null,o(t.$t("round"))+" "+o(p+1),1),s("div",Y,[s("div",Z,[s("span",null,o(e.sub),1),s("span",x,[s("span",{class:"hp",style:O(`width: ${e.aggressor.hpPercent}px`)},null,4)]),s("span",null,o(e.aggressor.hpPercent)+"%",1),s("span",null," hp: "+o(e.aggressor.hp)+"/"+o(e.aggressor.oriHp),1),s("span",null,o(t.$t("waigong"))+": "+o(e.aggressor.waigong),1),s("span",null,o(t.$t("neigong"))+": "+o(e.aggressor.neigong),1),s("span",null,o(t.$t("waifang"))+": "+o(e.aggressor.waifang),1),s("span",null,o(t.$t("neifang"))+": "+o(e.aggressor.neifang),1),s("span",null,o(t.$t("huixin"))+": "+o(e.aggressor.huixin),1),s("span",null,o(t.$t("huishang"))+": "+o(e.aggressor.huishang),1),s("span",null,o(t.$t("renxing"))+": "+o(e.aggressor.renxing),1)]),s("div",tt,o(e.aggressor.nickname)+" 对 "+o(e.victim.nickname)+" 造成了 "+o(e.damage)+"点 "+o(e.crit?"暴击伤害":"伤害"),1),s("div",ot,[s("span",null,o(e.obj),1),s("span",st,[s("span",{class:"hp",style:O(`width: ${e.victim.hpPercent}px`)},null,4)]),s("span",null,o(e.victim.hpPercent),1),s("span",null," hp: "+o(e.victim.hp)+"/"+o(e.victim.oriHp),1),s("span",null,o(t.$t("waigong"))+": "+o(e.victim.waigong),1),s("span",null,o(t.$t("neigong"))+": "+o(e.victim.neigong),1),s("span",null,o(t.$t("waifang"))+": "+o(e.victim.waifang),1),s("span",null,o(t.$t("neifang"))+": "+o(e.victim.neifang),1),s("span",null,o(t.$t("huixin"))+": "+o(e.victim.huixin),1),s("span",null,o(t.$t("huishang"))+": "+o(e.victim.huishang),1),s("span",null,o(t.$t("renxing"))+": "+o(e.victim.renxing),1)])])]))),256))])]),_:1},8,["open","title"])}const et=N(z,[["render",nt],["__scopeId","data-v-0b156f34"]]),it={fight:{toRolePoint:"1",toMonster:"1",toBoss:"2"}},at={name:"Fight",components:{FightModal:et,QuestionCircleOutlined:S},setup(){const{t}=j(),n=T({uid:sessionStorage.getItem("uid"),missionPoint:"",enemyName:"",enemyId:"",roleOptionsList:[],fightLog:[],spoils:[],currentMonsterWinRate:"0%",currentBossWinRate:"0%",modalVisible:!1});Q(async()=>{await u(),await r(),await e()});const u=async()=>{let l=await P.getRoleList({});n.roleOptionsList=l.data.filter(g=>g.uid!==n.uid).map(g=>({label:g.nickname,value:g.uid})),n.missionPoint=l.data.find(g=>g.uid===n.uid).missionpoint},i=async()=>{let l=await P.getInfo({uid:n.uid});n.missionPoint=l.data.baseInfo.missionpoint},M=async()=>{I.confirm({title:`${t("attackRoleTips")}：${n.enemyName}?`,content:a("div",{style:"color:red;"}),okText:t("attack"),cancelText:t("cancel"),async onOk(){let l=await w.toRole({uid:n.uid,enemyId:String(n.enemyId)});n.fightLog=l.data.fightLog,n.spoils=l.data.spoils,n.modalVisible=!0,await i()}})},h=async l=>{I.confirm({title:`${t("attackMonsterTips")}：${t("toMonster")}?`,content:a("div",{style:"color:red;"}),async onOk(){let g=await w.toMonster({uid:n.uid,type:l});n.fightLog=g.data.fightLog,n.spoils=g.data.spoils,n.modalVisible=!0,await i()}})},m=async()=>{I.confirm({title:`${t("attackMonsterTips")}：${t("toBoss")}?`,content:a("div",{style:"color:red;"}),async onOk(){let l=await w.toBoss({uid:n.uid});n.fightLog=l.data.fightLog,n.spoils=l.data.spoils,n.modalVisible=!0,await i()}})},r=async()=>{let l=await w.toImitMonster({uid:n.uid}),g=0,C=JSON.parse(sessionStorage.getItem("userInfo")).nickname;for(let v=0;v<l.data.fightLogs.length;v++)l.data.fightLogs[v].sub===C&&g++;n.currentMonsterWinRate=g+"%"},e=async()=>{let l=await w.toImitBoss({uid:n.uid}),g=0,C=JSON.parse(sessionStorage.getItem("userInfo")).nickname;for(let v=0;v<l.data.fightLogs.length;v++)l.data.fightLogs[v].sub===C&&g++;n.currentBossWinRate=g+"%"},p=(l,g)=>{n.enemyName=n.roleOptionsList.find(C=>C.label===g.label).label},f=()=>{},y=()=>{},W=(l,g)=>g.value.toLowerCase().indexOf(l.toLowerCase())>=0,F=()=>{n.modalVisible=!1};return{...L(n),baseConfig:it,filterOption:W,handleChange:p,handleBlur:f,handleFocus:y,QuestionCircleOutlined:S,toRole:M,toMonster:h,toImitMonster:r,toImitBoss:e,toBoss:m,modalClose:F}}},lt={class:"fight"},rt={class:"missionPoint"},dt={class:"class"},gt={class:"row"},ct={class:"classTitle"},pt={class:"toRole"},ut={class:"row"},mt={class:"classTitle"},ft={class:"toMonster"},ht={class:"toMonster"},yt={class:"toMonster"},vt={class:"row"},$t={class:"classTitle"},bt={class:"toBoss"};function kt(t,n,u,i,M,h){const m=b("a-select"),r=b("a-button"),e=b("QuestionCircleOutlined"),p=b("a-tooltip"),f=b("FightModal");return $(),k(R,null,[s("div",lt,[s("p",rt,o(t.$t("missionPoint"))+"："+o(t.missionPoint),1),s("div",dt,[s("div",gt,[s("p",ct,o(t.$t("toRole")),1),s("div",pt,[s("p",null,o(t.$t("useMissionPoint"))+"： "+o(i.baseConfig.fight.toRolePoint),1),a(m,{value:t.enemyId,"onUpdate:value":n[0]||(n[0]=y=>t.enemyId=y),"show-search":"",placeholder:"Select a person",options:t.roleOptionsList,"filter-option":i.filterOption,onFocus:i.handleFocus,onBlur:i.handleBlur,onChange:i.handleChange},null,8,["value","options","filter-option","onFocus","onBlur","onChange"]),a(r,{type:"primary",onClick:i.toRole,disabled:!t.enemyId},{default:d(()=>[c(o(t.$t("attack")),1)]),_:1},8,["onClick","disabled"])])]),s("div",ut,[s("p",mt,o(t.$t("toMonster")),1),s("div",ft,[s("p",null,o(t.$t("gainWeapon")),1),s("p",null,o(t.$t("useMissionPoint"))+"： "+o(i.baseConfig.fight.toMonster),1),a(r,{type:"primary",onClick:n[1]||(n[1]=y=>i.toMonster("2"))},{default:d(()=>[c(o(t.$t("attack")),1)]),_:1}),a(r,{type:"primary",onClick:i.toImitMonster},{default:d(()=>[c(o(t.$t("imitAttack")),1)]),_:1},8,["onClick"]),s("div",null,[c(o(t.$t("currentWinRate"))+" "+o(t.currentMonsterWinRate)+" ",1),a(p,null,{title:d(()=>[c(o(t.$t("monsterTips")),1)]),default:d(()=>[a(e,{style:{color:"#d2d2d2"}})]),_:1})])]),s("div",ht,[s("p",null,o(t.$t("gainArmor")),1),s("p",null,o(t.$t("useMissionPoint"))+"： "+o(i.baseConfig.fight.toMonster),1),a(r,{type:"primary",onClick:n[2]||(n[2]=y=>i.toMonster("3"))},{default:d(()=>[c(o(t.$t("attack")),1)]),_:1}),a(r,{type:"primary",onClick:i.toImitMonster},{default:d(()=>[c(o(t.$t("imitAttack")),1)]),_:1},8,["onClick"]),s("div",null,[c(o(t.$t("currentWinRate"))+" "+o(t.currentMonsterWinRate)+" ",1),a(p,null,{title:d(()=>[c(o(t.$t("monsterTips")),1)]),default:d(()=>[a(e,{style:{color:"#d2d2d2"}})]),_:1})])]),s("div",yt,[s("p",null,o(t.$t("gainOrnament")),1),s("p",null,o(t.$t("useMissionPoint"))+"： "+o(i.baseConfig.fight.toMonster),1),a(r,{type:"primary",onClick:n[3]||(n[3]=y=>i.toMonster("4"))},{default:d(()=>[c(o(t.$t("attack")),1)]),_:1}),a(r,{type:"primary",onClick:i.toImitMonster},{default:d(()=>[c(o(t.$t("imitAttack")),1)]),_:1},8,["onClick"]),s("div",null,[c(o(t.$t("currentWinRate"))+" "+o(t.currentMonsterWinRate)+" ",1),a(p,null,{title:d(()=>[c(o(t.$t("monsterTips")),1)]),default:d(()=>[a(e,{style:{color:"#d2d2d2"}})]),_:1})])])]),s("div",vt,[s("p",$t,o(t.$t("toBoss")),1),s("div",bt,[s("p",null,o(t.$t("useMissionPoint"))+"："+o(i.baseConfig.fight.toBoss),1),a(r,{type:"primary",onClick:i.toBoss},{default:d(()=>[c(o(t.$t("attack")),1)]),_:1},8,["onClick"]),a(r,{type:"primary",onClick:i.toImitBoss},{default:d(()=>[c(o(t.$t("imitAttack")),1)]),_:1},8,["onClick"]),s("div",null,[c(o(t.$t("currentWinRate"))+" "+o(t.currentBossWinRate)+" ",1),a(p,null,{title:d(()=>[c(o(t.$t("bossTips")),1)]),default:d(()=>[a(e,{style:{color:"#d2d2d2"}})]),_:1})])])])])]),a(f,{modalVisible:t.modalVisible,fightLog:t.fightLog,spoils:t.spoils,onSubmit:i.modalClose},null,8,["modalVisible","fightLog","spoils","onSubmit"])],64)}const wt=N(at,[["render",kt],["__scopeId","data-v-43791d88"]]);export{wt as default};
//# sourceMappingURL=Fight-DR9r-83m.js.map
