import{a as I}from"./axios-3UtZxvnF.js";import{_ as T,r as N,x as B,t as k,g as y,m as F,w as p,b as l,a as n,d as t,c as _,z as O,F as C,C as R,i as h,f,p as P,h as V,n as H,M as S,Q as J,o as j}from"./index-s-0WH2ku.js";import{a as A}from"./roleApi-Dxd_LJTB.js";const w={toRole:s=>I("postjson","/fightToRole",s),toMonster:s=>I("postjson","/fightToMonster",s),toBoss:s=>I("postjson","/fightToBoss",s),toImitMonster:s=>I("postjson","/fightToImitMonster",s),toImitBoss:s=>I("postjson","/fightToImitBoss",s)},U={name:"FightModal",props:{modalVisible:{default:!1,type:Boolean},fightLog:{default:[],type:Array},spoils:{default:[],type:Array}},emits:["submit"],setup(s,e){const r=N({}),i=()=>{e.emit("submit")},b=B(()=>{let $=0,c=0;return s.fightLog.map((a,o)=>{let m={},u={};return o%2===0?(m=JSON.parse(JSON.stringify(a.myAttr)),u=JSON.parse(JSON.stringify(a.enemyAttr))):(m=JSON.parse(JSON.stringify(a.enemyAttr)),u=JSON.parse(JSON.stringify(a.myAttr))),$=m.hp/m.oriHp*100,c=u.hp/u.oriHp*100,{...a,aggressor:{...m,hpPercent:$>0?$.toFixed(2):"0"},victim:{...u,hpPercent:c>0?c.toFixed(2):"0"}}})});return{...k(s),...k(r),submit:i,fightLogRender:b}}},Q=s=>(P("data-v-33645f75"),s=s(),V(),s),z=Q(()=>n("span",null,"战利品：",-1)),D={key:0},E={style:{"margin-right":"5px"}},q=h(" 关闭 "),G={class:"LogContent"},K={class:"logs"},X={class:"logsItem"},Y={class:"sub"},Z={class:"oriHp"},x={class:"detail"},ss={class:"obj"},ts={class:"oriHp"};function ns(s,e,r,i,b,$){const c=f("a-button"),a=f("a-modal");return y(),F(a,{open:r.modalVisible,"onUpdate:open":e[0]||(e[0]=o=>r.modalVisible=o),title:s.$t("battleLog"),width:"1024px"},{footer:p(()=>[l(c,{type:"primary",onClick:i.submit,onCancel:i.submit},{default:p(()=>[q]),_:1},8,["onClick","onCancel"])]),default:p(()=>[n("p",null,"结果："+t(r.fightLog[r.fightLog.length-1].sub)+" 胜",1),z,r.spoils.length===0?(y(),_("span",D,"无")):(y(!0),_(C,{key:1},O(r.spoils,o=>(y(),_("span",E,t(o.name),1))),256)),n("div",G,[(y(!0),_(C,null,O(i.fightLogRender,(o,m)=>(y(),_("div",K,[n("p",null,t(s.$t("round"))+" "+t(m+1),1),n("div",X,[n("div",Y,[n("span",null,t(o.sub),1),n("span",Z,[n("span",{class:"hp",style:R(`width: ${o.aggressor.hpPercent}px`)},null,4)]),n("span",null,t(o.aggressor.hpPercent)+"%",1),n("span",null," hp: "+t(o.aggressor.hp)+"/"+t(o.aggressor.oriHp),1),n("span",null,t(s.$t("waigong"))+": "+t(o.aggressor.waigong),1),n("span",null,t(s.$t("neigong"))+": "+t(o.aggressor.neigong),1),n("span",null,t(s.$t("waifang"))+": "+t(o.aggressor.waifang),1),n("span",null,t(s.$t("neifang"))+": "+t(o.aggressor.neifang),1),n("span",null,t(s.$t("huixin"))+": "+t(o.aggressor.huixin),1),n("span",null,t(s.$t("huishang"))+": "+t(o.aggressor.huishang),1),n("span",null,t(s.$t("renxing"))+": "+t(o.aggressor.renxing),1)]),n("div",x,t(o.aggressor.nickname)+" 对 "+t(o.victim.nickname)+" 造成了 "+t(o.damage)+"点 "+t(o.crit?"暴击伤害":"伤害"),1),n("div",ss,[n("span",null,t(o.obj),1),n("span",ts,[n("span",{class:"hp",style:R(`width: ${o.victim.hpPercent}px`)},null,4)]),n("span",null,t(o.victim.hpPercent),1),n("span",null," hp: "+t(o.victim.hp)+"/"+t(o.victim.oriHp),1),n("span",null,t(s.$t("waigong"))+": "+t(o.victim.waigong),1),n("span",null,t(s.$t("neigong"))+": "+t(o.victim.neigong),1),n("span",null,t(s.$t("waifang"))+": "+t(o.victim.waifang),1),n("span",null,t(s.$t("neifang"))+": "+t(o.victim.neifang),1),n("span",null,t(s.$t("huixin"))+": "+t(o.victim.huixin),1),n("span",null,t(s.$t("huishang"))+": "+t(o.victim.huishang),1),n("span",null,t(s.$t("renxing"))+": "+t(o.victim.renxing),1)])])]))),256))])]),_:1},8,["open","title"])}const os=T(U,[["render",ns],["__scopeId","data-v-33645f75"]]),es={fight:{toRolePoint:"1",toMonster:"1",toBoss:"2"}},is={name:"FightModal",props:{modalVisible:{default:!1,type:Boolean},fightLog:{default:[],type:Array},spoils:{default:[],type:Array}},emits:["submit"],setup(s,e){const r=N({userInfo:sessionStorage.getItem("userInfo")}),i=()=>{e.emit("submit")},b=B(()=>{let c=0,a=0;return s.fightLog.map((o,m)=>{let u={},v={};return m%2===0?(u=JSON.parse(JSON.stringify(o.myAttr)),v=JSON.parse(JSON.stringify(o.enemyAttr))):(u=JSON.parse(JSON.stringify(o.enemyAttr)),v=JSON.parse(JSON.stringify(o.myAttr))),c=u.hp/u.oriHp*100,a=v.hp/v.oriHp*100,{...o,aggressor:{...u,hpPercent:c>0?c.toFixed(2):"0"},victim:{...v,hpPercent:a>0?a.toFixed(2):"0"}}})}),$=B(()=>s.fightLog.filter(c=>c.sub===JSON.parse(r.userInfo).nickname).length);return{...k(s),...k(r),submit:i,fightLogRender:b,winLength:$}}},as=s=>(P("data-v-76a4b92a"),s=s(),V(),s),ls=as(()=>n("span",null,"战利品：",-1)),rs={key:0},gs={style:{"margin-right":"5px"}},ds=h(" 关闭 "),ps={class:"LogContent"},us={class:"logs"},cs={class:"logsItem"},hs={class:"sub"},ms={class:"oriHp"},fs={class:"detail"},ys={class:"obj"},$s={class:"oriHp"};function vs(s,e,r,i,b,$){const c=f("a-button"),a=f("a-modal");return y(),F(a,{open:r.modalVisible,"onUpdate:open":e[0]||(e[0]=o=>r.modalVisible=o),title:s.$t("battleLog"),width:"1024px"},{footer:p(()=>[l(c,{type:"primary",onClick:i.submit,onCancel:i.submit},{default:p(()=>[ds]),_:1},8,["onClick","onCancel"])]),default:p(()=>[n("p",null,"进攻次数："+t(r.fightLog.length),1),n("p",null,"获胜次数："+t(i.winLength),1),ls,r.spoils.length===0?(y(),_("span",rs,"无")):(y(!0),_(C,{key:1},O(r.spoils,o=>(y(),_("span",gs,t(o.name),1))),256)),n("div",ps,[(y(!0),_(C,null,O(i.fightLogRender,(o,m)=>(y(),_("div",us,[n("p",null,t(s.$t("round"))+" "+t(m+1),1),n("div",cs,[n("div",hs,[n("span",null,t(o.sub),1),n("span",ms,[n("span",{class:"hp",style:R(`width: ${o.aggressor.hpPercent}px`)},null,4)]),n("span",null,t(o.aggressor.hpPercent)+"%",1),n("span",null," hp: "+t(o.aggressor.hp)+"/"+t(o.aggressor.oriHp),1),n("span",null,t(s.$t("waigong"))+": "+t(o.aggressor.waigong),1),n("span",null,t(s.$t("neigong"))+": "+t(o.aggressor.neigong),1),n("span",null,t(s.$t("waifang"))+": "+t(o.aggressor.waifang),1),n("span",null,t(s.$t("neifang"))+": "+t(o.aggressor.neifang),1),n("span",null,t(s.$t("huixin"))+": "+t(o.aggressor.huixin),1),n("span",null,t(s.$t("huishang"))+": "+t(o.aggressor.huishang),1),n("span",null,t(s.$t("renxing"))+": "+t(o.aggressor.renxing),1)]),n("div",fs,t(o.aggressor.nickname)+" 对 "+t(o.victim.nickname)+" 造成了 "+t(o.damage)+"点 "+t(o.crit?"暴击伤害":"伤害"),1),n("div",ys,[n("span",null,t(o.obj),1),n("span",$s,[n("span",{class:"hp",style:R(`width: ${o.victim.hpPercent}px`)},null,4)]),n("span",null,t(o.victim.hpPercent),1),n("span",null," hp: "+t(o.victim.hp)+"/"+t(o.victim.oriHp),1),n("span",null,t(s.$t("waigong"))+": "+t(o.victim.waigong),1),n("span",null,t(s.$t("neigong"))+": "+t(o.victim.neigong),1),n("span",null,t(s.$t("waifang"))+": "+t(o.victim.waifang),1),n("span",null,t(s.$t("neifang"))+": "+t(o.victim.neifang),1),n("span",null,t(s.$t("huixin"))+": "+t(o.victim.huixin),1),n("span",null,t(s.$t("huishang"))+": "+t(o.victim.huishang),1),n("span",null,t(s.$t("renxing"))+": "+t(o.victim.renxing),1)])])]))),256))])]),_:1},8,["open","title"])}const _s=T(is,[["render",vs],["__scopeId","data-v-76a4b92a"]]),bs={name:"Monster",components:{FightModal:_s},setup(s,e){const{t:r}=H(),i=N({uid:sessionStorage.getItem("uid"),fightLog:[],spoils:[],modalVisible:!1,monsterList:[{label:r("gainWeapon"),value:"2"},{label:r("gainArmor"),value:"3"},{label:r("gainOrnament"),value:"4"}],monsterValue:"2",monsterTimes:"1"}),b=()=>{S.confirm({title:`${r("attackMonsterTips")} ${i.monsterTimes} 次${r("toMonster")}?`,content:l("div",{style:"color:red;"}),async onOk(){let a=await w.toMonster({uid:i.uid,type:i.monsterValue,times:i.monsterTimes});i.fightLog=a.data.fightLog,i.spoils=a.data.spoils,i.modalVisible=!0,e.emit("refresh","这是子组件传递的数据")}})},$=(a,o)=>{console.log(a,o)},c=()=>{i.modalVisible=!1};return{...k(i),chooseMonster:$,modalClose:c,toNewMonster:b}}},W=s=>(P("data-v-04672c91"),s=s(),V(),s),Ms={class:"newMonster"},ws={class:"choose"},ks=W(()=>n("span",null,"选择任务：",-1)),Cs={class:"choose"},Ls=W(()=>n("span",null,"进攻次数：",-1));function Is(s,e,r,i,b,$){const c=f("a-select"),a=f("a-input"),o=f("a-button"),m=f("FightModal");return y(),_(C,null,[n("div",Ms,[n("p",ws,[ks,l(c,{value:s.monsterValue,"onUpdate:value":e[0]||(e[0]=u=>s.monsterValue=u),"show-search":"",options:s.monsterList,onChange:i.chooseMonster},null,8,["value","options","onChange"])]),n("p",Cs,[Ls,l(a,{value:s.monsterTimes,"onUpdate:value":e[1]||(e[1]=u=>s.monsterTimes=u)},null,8,["value"])]),l(o,{type:"primary",onClick:i.toNewMonster},{default:p(()=>[h(t(s.$t("attack")),1)]),_:1},8,["onClick"])]),l(m,{modalVisible:s.modalVisible,fightLog:s.fightLog,spoils:s.spoils,onSubmit:i.modalClose},null,8,["modalVisible","fightLog","spoils","onSubmit"])],64)}const Ss=T(bs,[["render",Is],["__scopeId","data-v-04672c91"]]),Os={name:"Fight",components:{FightModal:os,Monster:Ss,QuestionCircleOutlined:J},setup(){const{t:s}=H(),e=N({uid:sessionStorage.getItem("uid"),missionPoint:"",enemyName:"",enemyId:"",roleOptionsList:[],fightLog:[],spoils:[],currentMonsterWinRate:"0%",currentBossWinRate:"0%",modalVisible:!1,weaponTimes:1,armorTimes:1,ornamentTimes:1,bossTimes:1});j(async()=>{await r(),await a(),await o()});const r=async()=>{let d=await A.getRoleList({});e.roleOptionsList=d.data.filter(g=>g.uid!==e.uid).map(g=>({label:g.nickname,value:g.uid})),e.missionPoint=d.data.find(g=>g.uid===e.uid).missionpoint},i=async()=>{let d=await A.getInfo({uid:e.uid});e.missionPoint=d.data.baseInfo.missionpoint},b=async()=>{S.confirm({title:`${s("attackRoleTips")}：${e.enemyName}?`,content:l("div",{style:"color:red;"}),okText:s("attack"),cancelText:s("cancel"),async onOk(){let d=await w.toRole({uid:e.uid,enemyId:String(e.enemyId)});e.fightLog=d.data.fightLog,e.spoils=d.data.spoils,e.modalVisible=!0,await i()}})},$=async d=>{S.confirm({title:`${s("attackMonsterTips")}：${s("toMonster")}?`,content:l("div",{style:"color:red;"}),async onOk(){let g=await w.toMonster({uid:e.uid,type:d});e.fightLog=g.data.fightLog,e.spoils=g.data.spoils,e.modalVisible=!0,await i()}})},c=async()=>{S.confirm({title:`${s("attackMonsterTips")}：${s("toBoss")}?`,content:l("div",{style:"color:red;"}),async onOk(){let d=await w.toBoss({uid:e.uid});e.fightLog=d.data.fightLog,e.spoils=d.data.spoils,e.modalVisible=!0,await i()}})},a=async()=>{let d=await w.toImitMonster({uid:e.uid}),g=0,L=JSON.parse(sessionStorage.getItem("userInfo")).nickname;for(let M=0;M<d.data.fightLogs.length;M++)d.data.fightLogs[M].sub===L&&g++;e.currentMonsterWinRate=g+"%"},o=async()=>{let d=await w.toImitBoss({uid:e.uid}),g=0,L=JSON.parse(sessionStorage.getItem("userInfo")).nickname;for(let M=0;M<d.data.fightLogs.length;M++)d.data.fightLogs[M].sub===L&&g++;e.currentBossWinRate=g+"%"},m=(d,g)=>{e.enemyName=e.roleOptionsList.find(L=>L.label===g.label).label},u=(d,g)=>g.value.toLowerCase().indexOf(d.toLowerCase())>=0,v=()=>{e.modalVisible=!1};return{...k(e),baseConfig:es,filterOption:u,chooseRole:m,QuestionCircleOutlined:J,toRole:b,toMonster:$,toImitMonster:a,toImitBoss:o,toBoss:c,modalClose:v,getRoleInfo:i}}},Rs=s=>(P("data-v-7bd23169"),s=s(),V(),s),Ts={class:"fight"},Ns={class:"missionPoint"},Ps={class:"class"},Vs={class:"row"},Bs={class:"classTitle"},Js={style:{"margin-right":"10px"}},As={class:"toRole"},Fs={class:"row"},Hs={class:"classTitle"},Ws={style:{"margin-right":"10px"}},js={class:"toMonster"},Us={class:"times"},Qs=Rs(()=>n("span",null,"进攻次数：",-1)),zs={class:"toMonster"},Ds={class:"toMonster"},Es={class:"row"},qs={class:"classTitle"},Gs={style:{"margin-right":"10px"}},Ks={class:"toBoss"};function Xs(s,e,r,i,b,$){const c=f("a-select"),a=f("a-button"),o=f("Monster"),m=f("a-input"),u=f("QuestionCircleOutlined"),v=f("a-tooltip"),d=f("FightModal");return y(),_(C,null,[n("div",Ts,[n("p",Ns,t(s.$t("missionPoint"))+"："+t(s.missionPoint),1),n("div",Ps,[n("div",Vs,[n("p",Bs,[n("span",Js,t(s.$t("toRole")),1),n("span",null,t(s.$t("useMissionPoint"))+"： "+t(i.baseConfig.fight.toRolePoint),1)]),n("div",As,[l(c,{value:s.enemyId,"onUpdate:value":e[0]||(e[0]=g=>s.enemyId=g),"show-search":"",placeholder:"Select a person",options:s.roleOptionsList,"filter-option":i.filterOption,onChange:i.chooseRole},null,8,["value","options","filter-option","onChange"]),l(a,{type:"primary",onClick:i.toRole,disabled:!s.enemyId},{default:p(()=>[h(t(s.$t("attack")),1)]),_:1},8,["onClick","disabled"])])]),n("div",Fs,[n("p",Hs,[n("span",Ws,t(s.$t("toMonster")),1),n("span",null,t(s.$t("useMissionPoint"))+"： "+t(i.baseConfig.fight.toMonster),1)]),l(o,{onRefresh:i.getRoleInfo},null,8,["onRefresh"]),n("div",js,[n("p",null,t(s.$t("gainWeapon")),1),n("p",Us,[Qs,l(m,{value:s.weaponTimes,"onUpdate:value":e[1]||(e[1]=g=>s.weaponTimes=g)},null,8,["value"])]),l(a,{type:"primary",onClick:e[2]||(e[2]=g=>i.toMonster("2"))},{default:p(()=>[h(t(s.$t("attack")),1)]),_:1}),l(a,{type:"primary",onClick:i.toImitMonster},{default:p(()=>[h(t(s.$t("imitAttack")),1)]),_:1},8,["onClick"]),n("div",null,[h(t(s.$t("currentWinRate"))+" "+t(s.currentMonsterWinRate)+" ",1),l(v,null,{title:p(()=>[h(t(s.$t("monsterTips")),1)]),default:p(()=>[l(u,{style:{color:"#d2d2d2"}})]),_:1})])]),n("div",zs,[n("p",null,t(s.$t("gainArmor")),1),n("p",null,t(s.$t("useMissionPoint"))+"： "+t(i.baseConfig.fight.toMonster),1),l(a,{type:"primary",onClick:e[3]||(e[3]=g=>i.toMonster("3"))},{default:p(()=>[h(t(s.$t("attack")),1)]),_:1}),l(a,{type:"primary",onClick:i.toImitMonster},{default:p(()=>[h(t(s.$t("imitAttack")),1)]),_:1},8,["onClick"]),n("div",null,[h(t(s.$t("currentWinRate"))+" "+t(s.currentMonsterWinRate)+" ",1),l(v,null,{title:p(()=>[h(t(s.$t("monsterTips")),1)]),default:p(()=>[l(u,{style:{color:"#d2d2d2"}})]),_:1})])]),n("div",Ds,[n("p",null,t(s.$t("gainOrnament")),1),n("p",null,t(s.$t("useMissionPoint"))+"： "+t(i.baseConfig.fight.toMonster),1),l(a,{type:"primary",onClick:e[4]||(e[4]=g=>i.toMonster("4"))},{default:p(()=>[h(t(s.$t("attack")),1)]),_:1}),l(a,{type:"primary",onClick:i.toImitMonster},{default:p(()=>[h(t(s.$t("imitAttack")),1)]),_:1},8,["onClick"]),n("div",null,[h(t(s.$t("currentWinRate"))+" "+t(s.currentMonsterWinRate)+" ",1),l(v,null,{title:p(()=>[h(t(s.$t("monsterTips")),1)]),default:p(()=>[l(u,{style:{color:"#d2d2d2"}})]),_:1})])])]),n("div",Es,[n("p",qs,[n("span",Gs,t(s.$t("toBoss")),1),n("span",null,t(s.$t("useMissionPoint"))+"："+t(i.baseConfig.fight.toBoss),1)]),n("div",Ks,[l(a,{type:"primary",onClick:i.toBoss},{default:p(()=>[h(t(s.$t("attack")),1)]),_:1},8,["onClick"]),l(a,{type:"primary",onClick:i.toImitBoss},{default:p(()=>[h(t(s.$t("imitAttack")),1)]),_:1},8,["onClick"]),n("div",null,[h(t(s.$t("currentWinRate"))+" "+t(s.currentBossWinRate)+" ",1),l(v,null,{title:p(()=>[h(t(s.$t("bossTips")),1)]),default:p(()=>[l(u,{style:{color:"#d2d2d2"}})]),_:1})])])])])]),l(d,{modalVisible:s.modalVisible,fightLog:s.fightLog,spoils:s.spoils,onSubmit:i.modalClose},null,8,["modalVisible","fightLog","spoils","onSubmit"])],64)}const st=T(Os,[["render",Xs],["__scopeId","data-v-7bd23169"]]);export{st as default};
//# sourceMappingURL=Fight-C6R77Djs.js.map
